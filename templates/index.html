<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本語教育チャットボット</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<div class="container mt-3">
    <!-- Tabs for switching between Chatbot, TeachMe, and Grammar Check -->
    <ul class="nav nav-tabs">
        <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#chatbot">チャットボット</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#teachme">日本語先生</a>
        </li>
    </ul>
    
    <div class="tab-content">
        <!-- Chatbot Tab -->
        <div id="chatbot" class="tab-pane active">
            <div class="row">
                <!-- Chatbox and Input area -->
                <div class="col-md-6">
                    <div class="chat-container">
                        <div id="chat-box" class="mb-3" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px;"></div>
                        <div class="input-group">
                            <input type="text" id="message-input" class="form-control" placeholder="入力してください" aria-label="Message">
                            <span id="correct-sign" style="display: none; color: green; margin-left: 10px;">✔️</span>
                            <div class="input-group-append">
                                <button class="btn btn-primary" type="button" onclick="sendMessage()">送信</button>
                                <button class="btn btn-secondary" type="button" id="speech-btn" onclick="toggleRecognition()">🎤</button>
                                <button class="btn btn-danger" type="button" onclick="clearChat()">クリアチャット</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grammar correction area -->
                <div class="col-md-6">
                    <div id="grammar-corrections" class="chat-container" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px;">
                        <h5>文法訂正</h5>
                    </div>
                    <button class="btn btn-info mt-2" type="button" onclick="checkLastUserMessageGrammar()">インプットチェック</button>
                     <!-- New Explanation Button -->
                    <button class="btn btn-warning mt-2" type="button" onclick="explainLastBotOutput()">アウトプットチェック</button>

                </div>
            </div>

            <!-- Dropdown for voice and model selection -->
            <div class="mt-3">
                <label for="voice-select">音声: </label>
                <select id="voice-select" class="form-control"></select>
            </div>
            <div class="mt-3">
                <label for="model-select">モデル: </label>
                <select id="model-select" class="form-control">
                    <option value="gpt-3.5-turbo">敬語</option>
                    <option value="ft:gpt-3.5-turbo-0125:personal:chatbot-tameguchi:9h91UVHL">タメ口</option>
                    <option value="ft:gpt-3.5-turbo-0125:personal:japanese-chatbot-terrace:ARAneXfD">パーソナライズモデル (Terrace)</option>
                </select>
            </div>
        </div>

        <!-- TeachMe Tab -->
        <div id="teachme" class="tab-pane fade">
            <div class="mt-3">
                <input type="text" id="teachme-input" class="form-control" placeholder="質問を入力してください">
                <label for="language-select">言語: </label>
                <select id="language-select" class="form-control">
                    <option value="ja">日本語</option>
                    <option value="en">English</option>
                    <option value="id">Indonesia</option>
                </select>
                <button class="btn btn-primary mt-2" type="button" onclick="askQuestion()">送信</button>
                <div id="teachme-response" class="mt-3"></div>
            </div>
        </div>

    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="/static/script.js"></script>
</body>
</html>
